---
title: "Serving a fish model"
author: "Lindy Rauchenstein"
date: "2025-02-09"
image: "bass.png"
warning: false
format:
  html:
    ipywidgets: embed
execute:
  echo:
    false
---

```{python}
from fastbook import *
from fastai.vision import *
from fastai.vision.widgets import *
```

```{python}
learn_inf = load_learner('export.pkl')
```

```{python}
uploader = widgets.FileUpload()
out_pl = widgets.Output()
lbl_pred = widgets.Label()
```

```{python}
btn_run = widgets.Button(description='Classify')

def on_click_classify(change):
    img = PILImage.create(uploader.value[0].content.tobytes())
    out_pl.clear_output()
    with out_pl: display(img.to_thumb(128,128))
    category,idx,probs = learn_inf.predict(img)
    lbl_pred.value = f'Prediction: {category}; Probability: {probs[idx]:.04f}'

btn_run.on_click(on_click_classify)

```

```{python}
VBox([widgets.Label('Upload an image of a fish to classify!'),
      uploader, btn_run, out_pl, lbl_pred])
```


